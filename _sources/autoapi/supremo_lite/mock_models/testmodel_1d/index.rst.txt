supremo_lite.mock_models.testmodel_1d
=====================================

.. py:module:: supremo_lite.mock_models.testmodel_1d

.. autoapi-nested-parse::

   Mock 1D genomic prediction model for testing and demonstrations.

   This module provides a simple PyTorch model that mimics realistic genomic deep learning
   architectures. It is intended for:
   1. Testing prediction alignment functionality
   2. Providing runnable examples for users without trained models

   **NOT for actual genomic predictions** - this model returns constant values and has
   no learned parameters.

   Model Architecture Characteristics:
   - **Binning**: Predictions at lower resolution than input (bin_size parameter)
   - **Cropping**: Edge bins removed to focus on central regions (crop_length parameter)
   - **Output shape**: (batch_size, n_targets, n_final_bins)

   .. rubric:: Example

   >>> from supremo_lite.mock_models import TestModel
   >>> import torch
   >>>
   >>> model = TestModel(seq_length=1024, bin_length=32, crop_length=128, n_targets=1)
   >>> x = torch.randn(8, 4, 1024)  # (batch, channels, length)
   >>> predictions = model(x)
   >>> predictions.shape
   torch.Size([8, 1, 28])  # (batch, targets, bins after cropping)



Attributes
----------

.. autoapisummary::

   supremo_lite.mock_models.testmodel_1d.TORCH_AVAILABLE


Classes
-------

.. autoapisummary::

   supremo_lite.mock_models.testmodel_1d.TestModel


Module Contents
---------------

.. py:data:: TORCH_AVAILABLE
   :value: True


.. py:class:: TestModel(seq_length, bin_length, crop_length=0, n_targets=1)

   Bases: :py:obj:`torch.nn.Module`


   Mock 1D genomic prediction model.

   This model demonstrates typical genomic deep learning architecture features:
   - Accepts one-hot encoded DNA sequences
   - Outputs binned predictions at lower resolution
   - Applies edge cropping to focus on central regions

   **Warning**: Returns constant values (ones). Not for actual predictions.

   :param seq_length: Length of input sequences in base pairs
   :type seq_length: int
   :param bin_length: Number of base pairs per prediction bin
   :type bin_length: int
   :param crop_length: Number of base pairs to crop from each edge (default: 0)
   :type crop_length: int, optional
   :param n_targets: Number of prediction targets per bin (default: 1)
   :type n_targets: int, optional

   .. rubric:: Examples

   Basic usage:

   >>> model = TestModel(seq_length=1024, bin_length=32)
   >>> x = torch.randn(4, 4, 1024)  # (batch, channels, length)
   >>> out = model(x)
   >>> out.shape
   torch.Size([4, 1, 32])

   With cropping:

   >>> model = TestModel(seq_length=2048, bin_length=64, crop_length=256)
   >>> model.n_initial_bins
   32
   >>> model.crop_bins
   4
   >>> model.n_final_bins
   24


   .. py:attribute:: seq_length


   .. py:attribute:: bin_length


   .. py:attribute:: crop_length
      :value: 0



   .. py:attribute:: n_targets
      :value: 1



   .. py:attribute:: crop_bins


   .. py:attribute:: n_initial_bins


   .. py:attribute:: n_final_bins


   .. py:method:: forward(x)

      Forward pass returning mock predictions.

      :param x: Input tensor of shape (batch_size, 4, seq_length)
                Channel dimension should be 4 (one-hot encoded A, C, G, T)
      :type x: torch.Tensor

      :returns: Mock predictions of shape (batch_size, n_targets, n_final_bins)
                Contains all ones (not meaningful predictions)
      :rtype: torch.Tensor



   .. py:method:: training_step(batch, batch_idx)

      Mock training step for demonstration purposes.

      Shows how cropping would be applied during training.
      This is for educational purposes only - the model has no learnable parameters.



